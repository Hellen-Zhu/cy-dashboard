# Sorry Cypress æœ¬åœ°éƒ¨ç½²æ­¥éª¤ç¬”è®°

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

Sorry Cypress æ˜¯ä¸€ä¸ªå¼€æºçš„ Cypress Dashboard æ›¿ä»£æ–¹æ¡ˆï¼Œæä¾›ï¼š
- æ— é™åˆ¶çš„å¹¶è¡Œæµ‹è¯•æ‰§è¡Œ
- æˆªå›¾å’Œè§†é¢‘ä¸Šä¼ åˆ°è‡ªå·±çš„å­˜å‚¨
- æµ‹è¯•ç»“æœæµè§ˆ
- è‡ªæ‰˜ç®¡è§£å†³æ–¹æ¡ˆ
- GitHubã€Slack ç­‰é›†æˆ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

é¡¹ç›®åŒ…å«ä»¥ä¸‹æ ¸å¿ƒæœåŠ¡ï¼š
- **Director**: æµ‹è¯•æ‰§è¡Œåè°ƒå™¨ (ç«¯å£ 1234)
- **API**: GraphQL API æœåŠ¡ (ç«¯å£ 4000)
- **Dashboard**: Web ç•Œé¢ (ç«¯å£ 8081)
- **MongoDB**: æ•°æ®å­˜å‚¨ (ç«¯å£ 27017)
- **MinIO**: æ–‡ä»¶å­˜å‚¨æœåŠ¡ (ç«¯å£ 9000/9090)

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: ç¯å¢ƒæ£€æŸ¥

```bash
# æ£€æŸ¥ Docker ç‰ˆæœ¬
docker --version

# æ£€æŸ¥ Docker Compose ç‰ˆæœ¬
docker-compose --version

# æ£€æŸ¥å½“å‰ç›®å½•
pwd
# åº”è¯¥æ˜¾ç¤º: /Users/hellen/cypress/sorry-cypress
```

### æ­¥éª¤ 2: åˆ›å»ºæœ¬åœ°é…ç½®æ–‡ä»¶

```bash
# å¤åˆ¶ MinIO é…ç½®æ–‡ä»¶ä½œä¸ºæœ¬åœ°é…ç½®
cp docker-compose.minio.yml docker-compose.local.yml
```

**é…ç½®æ–‡ä»¶è¯´æ˜**:
- ä½¿ç”¨ `docker-compose.minio.yml` ä½œä¸ºåŸºç¡€
- åŒ…å«å®Œæ•´çš„å­˜å‚¨è§£å†³æ–¹æ¡ˆ
- æ”¯æŒæˆªå›¾å’Œè§†é¢‘å­˜å‚¨

### æ­¥éª¤ 3: ä¿®æ”¹é…ç½®æ–‡ä»¶

éœ€è¦ä¿®æ”¹ä»¥ä¸‹é…ç½®é¡¹ï¼š

#### MongoDB é…ç½®
```yaml
mongo:
  environment:
    MONGO_INITDB_ROOT_USERNAME: 'admin'
    MONGO_INITDB_ROOT_PASSWORD: 'password'
```

#### Director æœåŠ¡é…ç½®
```yaml
director:
  environment:
    DASHBOARD_URL: http://localhost:8081  # ä¿®æ”¹ç«¯å£é¿å…å†²çª
    MONGODB_URI: 'mongodb://admin:password@mongo:27017'
    MINIO_ACCESS_KEY: 'minioadmin'
    MINIO_SECRET_KEY: 'minioadmin'
    MINIO_ENDPOINT: 'localhost'
    MINIO_URL: 'http://localhost'
```

#### API æœåŠ¡é…ç½®
```yaml
api:
  environment:
    MONGODB_URI: 'mongodb://admin:password@mongo:27017'
    MONGODB_DATABASE: 'sorry-cypress'
```

#### Dashboard æœåŠ¡é…ç½®
```yaml
dashboard:
  ports:
    - 8081:8080  # ä¿®æ”¹å¤–éƒ¨ç«¯å£é¿å…å†²çª
  environment:
    GRAPHQL_SCHEMA_URL: http://localhost:4000
```

#### MinIO å­˜å‚¨é…ç½®
```yaml
storage:
  environment:
    MINIO_ROOT_USER: 'minioadmin'
    MINIO_ROOT_PASSWORD: 'minioadmin'
```

### æ­¥éª¤ 4: åˆ›å»ºæ•°æ®ç›®å½•

```bash
# åˆ›å»º MongoDB æ•°æ®ç›®å½•
mkdir -p data/data-mongo-cypress

# åˆ›å»º MinIO æ•°æ®ç›®å½•
mkdir -p data/data-minio-cypress

# éªŒè¯ç›®å½•åˆ›å»º
ls -la data/
```

### æ­¥éª¤ 5: å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.local.yml up -d

# æŸ¥çœ‹å¯åŠ¨çŠ¶æ€
docker-compose -f docker-compose.local.yml ps
```

**é¢„æœŸè¾“å‡º**:
```
NAME                        STATUS         PORTS
sorry-cypress-api-1         Up 4 seconds   0.0.0.0:4000->4000/tcp
sorry-cypress-dashboard-1   Up 4 seconds   0.0.0.0:8081->8080/tcp
sorry-cypress-director-1    Up 4 seconds   0.0.0.0:1234->1234/tcp, 0.0.0.0:9000->9000/tcp, 0.0.0.0:9090->9090/tcp
sorry-cypress-mongo-1       Up 4 seconds   0.0.0.0:27017->27017/tcp
```

### æ­¥éª¤ 6: éªŒè¯æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥æœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.local.yml logs --tail=20

# æµ‹è¯•æœåŠ¡å“åº”
curl -s -o /dev/null -w "%{http_code}" http://localhost:8081  # Dashboard
curl -s -o /dev/null -w "%{http_code}" http://localhost:4000  # API
curl -s -o /dev/null -w "%{http_code}" http://localhost:1234  # Director
```

**é¢„æœŸå“åº”ç **:
- Dashboard: 200
- API: 400 (GraphQL ç«¯ç‚¹)
- Director: 302 (é‡å®šå‘)

## ğŸ“Š æœåŠ¡è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| Dashboard | http://localhost:8081 | Web ç®¡ç†ç•Œé¢ |
| API | http://localhost:4000 | GraphQL API |
| Director | http://localhost:1234 | æµ‹è¯•åè°ƒå™¨ |
| MinIO æ§åˆ¶å° | http://localhost:9090 | æ–‡ä»¶å­˜å‚¨ç®¡ç† |
| MinIO API | http://localhost:9000 | æ–‡ä»¶å­˜å‚¨ API |
| MongoDB | localhost:27017 | æ•°æ®åº“ |

## ğŸ” ç™»å½•å‡­æ®

| æœåŠ¡ | ç”¨æˆ·å | å¯†ç  |
|------|--------|------|
| MongoDB | admin | password |
| MinIO | minioadmin | minioadmin |

## ğŸ› ï¸ æœåŠ¡ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
docker-compose -f docker-compose.local.yml ps
```

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.local.yml logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.local.yml logs dashboard
docker-compose -f docker-compose.local.yml logs api
docker-compose -f docker-compose.local.yml logs director
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.local.yml restart

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose.local.yml restart dashboard
```

### åœæ­¢æœåŠ¡
```bash
docker-compose -f docker-compose.local.yml down
```

### æ¸…ç†æ•°æ®
```bash
# åœæ­¢æœåŠ¡
docker-compose -f docker-compose.local.yml down

# åˆ é™¤æ•°æ®ç›®å½•ï¼ˆè°¨æ…æ“ä½œï¼‰
rm -rf data/

# é‡æ–°åˆ›å»ºç›®å½•
mkdir -p data/data-mongo-cypress data/data-minio-cypress
```

## ğŸ”§ æ•…éšœæ’é™¤

### ç«¯å£å†²çªé—®é¢˜
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8080
lsof -i :4000
lsof -i :1234

# è§£å†³æ–¹æ¡ˆï¼šä¿®æ”¹ docker-compose.local.yml ä¸­çš„ç«¯å£æ˜ å°„
```

### æœåŠ¡å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
docker-compose -f docker-compose.local.yml logs

# æ£€æŸ¥ Docker çŠ¶æ€
docker info

# é‡å¯ Docker æœåŠ¡
```

### æ•°æ®æŒä¹…åŒ–é—®é¢˜
```bash
# æ£€æŸ¥æ•°æ®ç›®å½•æƒé™
ls -la data/

# é‡æ–°åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p data/data-mongo-cypress data/data-minio-cypress
chmod 755 data/
```

## ğŸ“ å¿«é€Ÿå¯åŠ¨è„šæœ¬

åˆ›å»º `start-local.sh` è„šæœ¬ï¼š

```bash
#!/bin/bash

echo "ğŸš€ å¯åŠ¨ Sorry Cypress æœ¬åœ°æœåŠ¡..."

# æ£€æŸ¥ Docker æ˜¯å¦è¿è¡Œ
if ! docker info > /dev/null 2>&1; then
    echo "âŒ Docker æœªè¿è¡Œï¼Œè¯·å…ˆå¯åŠ¨ Docker"
    exit 1
fi

# åˆ›å»ºæ•°æ®ç›®å½•
echo "ğŸ“ åˆ›å»ºæ•°æ®ç›®å½•..."
mkdir -p data/data-mongo-cypress data/data-minio-cypress

# å¯åŠ¨æœåŠ¡
echo "ğŸ”§ å¯åŠ¨ Docker æœåŠ¡..."
docker-compose -f docker-compose.local.yml up -d

# ç­‰å¾…æœåŠ¡å¯åŠ¨
echo "â³ ç­‰å¾…æœåŠ¡å¯åŠ¨..."
sleep 10

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
echo "ğŸ“Š æ£€æŸ¥æœåŠ¡çŠ¶æ€..."
docker-compose -f docker-compose.local.yml ps

echo ""
echo "âœ… Sorry Cypress æœ¬åœ°æœåŠ¡å·²å¯åŠ¨ï¼"
echo ""
echo "ğŸŒ è®¿é—®åœ°å€ï¼š"
echo "   Dashboard: http://localhost:8081"
echo "   API:       http://localhost:4000"
echo "   Director:  http://localhost:1234"
echo "   MinIO:     http://localhost:9090 (ç”¨æˆ·å: minioadmin, å¯†ç : minioadmin)"
echo ""
echo "ğŸ›‘ åœæ­¢æœåŠ¡: docker-compose -f docker-compose.local.yml down"
```

è®¾ç½®æ‰§è¡Œæƒé™ï¼š
```bash
chmod +x start-local.sh
```

## ğŸ¯ ä½¿ç”¨æŒ‡å—

### 1. è®¿é—® Dashboard
æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:8081

### 2. åˆ›å»ºé¡¹ç›®
åœ¨ Dashboard ä¸­åˆ›å»ºæ–°çš„æµ‹è¯•é¡¹ç›®

### 3. é…ç½® Cypress
åœ¨æ‚¨çš„ Cypress é¡¹ç›®ä¸­å®‰è£…å’Œé…ç½® sorry-cypressï¼š

```bash
npm install --save-dev sorry-cypress
```

åœ¨ `cypress.config.js` ä¸­æ·»åŠ ï¼š
```javascript
const { defineConfig } = require('cypress')

module.exports = defineConfig({
  e2e: {
    setupNodeEvents(on, config) {
      // implement node event listeners here
    },
  },
  env: {
    sorryCypressUrl: 'http://localhost:1234'
  }
})
```

### 4. è¿è¡Œæµ‹è¯•
ä½¿ç”¨ sorry-cypress è¿è¡Œæ‚¨çš„ Cypress æµ‹è¯•

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®˜æ–¹æ–‡æ¡£](https://docs.sorry-cypress.dev)
- [GitHub ä»“åº“](https://github.com/agoldis/sorry-cypress)
- [æœ¬åœ°éƒ¨ç½²è¯´æ˜](LOCAL_DEPLOYMENT.md)

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] Docker å’Œ Docker Compose å·²å®‰è£…
- [ ] é…ç½®æ–‡ä»¶å·²åˆ›å»ºå’Œä¿®æ”¹
- [ ] æ•°æ®ç›®å½•å·²åˆ›å»º
- [ ] æ‰€æœ‰æœåŠ¡å·²å¯åŠ¨
- [ ] æœåŠ¡çŠ¶æ€æ£€æŸ¥é€šè¿‡
- [ ] ç«¯å£è®¿é—®æ­£å¸¸
- [ ] ç™»å½•å‡­æ®å¯ç”¨
- [ ] å¿«é€Ÿå¯åŠ¨è„šæœ¬å·²åˆ›å»º

---

**éƒ¨ç½²æ—¶é—´**: 2025-07-27  
**éƒ¨ç½²ç¯å¢ƒ**: macOS (darwin 24.5.0)  
**Docker ç‰ˆæœ¬**: 28.3.2  
**é¡¹ç›®ç‰ˆæœ¬**: 2.6.0 